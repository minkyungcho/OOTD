{% extends 'codi/base.html' %}
{% load static %}
{% block content %}

<section class="ftco-section">
  <div class="container" style="margin-top: 150px;">
    <div class="row justify-content-center">
      <div class="col-md-7 text-center heading-section ftco-animate">
        <span class="subheading">CodiBook</span>
        <h2 class="mb-3">My Codi</h2>
      </div>
    </div>
  </div>

    <div class="card text-center col-8" style="margin:0 auto;">
        <form action="{% url 'codi:codiBook' %}" method="POST" enctype="multipart/form-data">
            <input type="hidden" name="csrfmiddlewaretoken" value={{csrf_token}}>
            <div class="card text-center">
                <div class="card-body">
                    <textarea name="contents" class="form-control" rows="5"> </textarea>
                    {% comment %} <input placeholder="Insert HashTag" type="text" class="form-control mt-3" name="hashtag"> {% endcomment %}

                    <!-- img input tag -->
                    <div class="input-group mt-2">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">Upload</span>
                        </div>
                        <div class="custom-file">
                            <input name="image" type="file" class="custom-file-input" id="inputGroupFile01" aria-describedby="inputGroupFileAddon01" multiple>
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>

                </div>
                <div class="card-footer text-right">
                    <input type="submit" class="btn btn-success" value="작성하기">
                </div>
            </div>
        </form>
    </div>


    <div class="container">
        {% for article in articles %}
        <div class="row mt-4">
            <div class="card col-12">
                {% comment %} {% if article.article_images %}
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <!-- <ol class="carousel-indicators">
                      <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                      <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                      <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol> -->
                    <div class="carousel-inner">
                        {% for image in article.article_images %}
                        <div class="carousel-item">
                            <img src="{{image.image_thumbnail.url}}" class="d-block w-100" alt="...">
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %} {% endcomment %}

                <div class="card-body" style="min-height: 8rem;">
                    <p class="card-text">{{article.contents}}</p>
                    {% comment %} {% for tag in article.tags.all %}
                    <span>#{{tag.tag}}</span>
                    {% endfor %} {% endcomment %}


                    <div class="text-center">
                        <div class="row float-right">
                            <span class="muted">created by {{article.user.username}}</span>
                        </div>

                        {% comment %} {% if user in article.user_likes.all %}
                            <button type="button" class="btn btn-success likes" data-article-id='{{article.id}}'><i class="fas fa-thumbs-up"></i>{{len(article.user_likes.all)}}</button>
                        {% else %}
                            <button type="button" class="btn btn-secondary likes" data-article-id='{{article.id}}'><i class="fas fa-thumbs-up"></i></button>
                        {% endif %}
                        {% if article.user_id == user.id %}
                            <!-- login -->
                            <a href="{% url 'edit' article.id %}" class="btn btn-warning text-white editComment"><i class="fas fa-edit"></i></a>
                            <a href="{% url 'delete' article.id %}" class="btn btn-danger textwhite deleteComment"><i class="fas fa-trash-alt"></i></a>
                        {% endif %} {% endcomment %}
                    </div>
                </div>
                {% comment %} 
                <ul class="list-group list-group-flush" id="comment-list-group-{{article.id}}">
                    <li class="list-group-item">
                        <form method="POST" class="commentForm" id="commentForm-{{article.id}}">
                            <input type="hidden" name="csrfmiddlewaretoken" value="{{csrf_token}}">
                            <input type="hidden" class="articleId" name="article_id" value="{{article.id}}">
                            <input type="hidden" class="formMethod" name="form_method" value="create">
                            <input type="hidden" class="commentId" name="comment_id" >
                            <div class="row">
                                <div class="col-9">
                                    <input type="text" class="form-control commentInput" name="contents">
                                </div>
                                <div class="col-3 text-center">
                                    <input type="submit" class="btn btn-primary" value="댓글">
                                </div>
                            </div>
                        </form>
                    </li>
                    {% for comment in article.comments %}
                    <li class="list-group-item" id="comment-{{comment.id}}">
                        <i class="fas fa-comment-dots"></i>
                        <span>{{comment.user.username}} - </span>
                        <span class="contents">{{comment.contents}}</span>
                        <span class="float-right">
                            {% if comment.user_id == user.id %}
                                <button data-contents="{{comment.contents}}" data-article-id="{{article.id}}" data-id="{{comment.id}}" class="btn btn-warning editComment"><i class="fas fa-edit"></i></button>
                                <button data-id="{{comment.id}}" class="btn btn-danger deleteComment"><i class="fas fa-trash-alt"></i></button>
                            {% endif %}
                        </span>
                    </li>
                    {% endfor %} 
                </ul>{% endcomment %}
            </div>
        </div>
        {% endfor %}
    </div> 

</section>

{% comment %} <section>
    <form class="mb-5 mt-5" id="boardForm">
        댓글쓰기
        <input type="text" class="form-control" id="boardInput">
        <button type="submit" class="btn btn-primary" id="submitComment">확인</button>
    </form>

    <div class="commentList">
        <ul class="list-group">
            {% for board in boards %}
            <li class="list-group-item" id="board-{{board.id}}">
                <!-- 첫번째 댓글 -->

                <span class="boardItem">{{board.contents}}</span>

                <span class="float-right">
                    <button type="button" class="btn btn-danger deleteBoard" data-id="{{board.id}}">삭제</button>
                    <button type="button" class="btn btn-warning editBoard" data-id="{{board.id}}">수정</button>
                </span>
            </li>
            {% endfor %}
            <h3>hi</h3>
        </ul>
    </div>
</section> {% endcomment %}

{% endblock content %}


